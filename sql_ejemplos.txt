# Ejemplo 1
Pregunta: ¿Cuál es la cantidad total de cursos creados en la plataforma?
SQL:
SELECT COUNT(*) FROM {PREFIX}course;

# Ejemplo 2
Pregunta: ¿Cuántos estudiantes están matriculados en el curso 'Anatomía'?
SQL:
SELECT COUNT(DISTINCT u.id)
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON ue.enrolid = e.id
JOIN {PREFIX}course c ON c.id = e.courseid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Anatomía' AND ra.roleid = 5;

# Ejemplo 3
Pregunta: ¿Qué estudiantes tienen nota mayor a 7 en el curso 'Fisiología'?
SQL:
SELECT u.firstname, u.lastname, g.finalgrade
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades g ON g.userid = u.id
JOIN {PREFIX}grade_items gi ON gi.id = g.itemid
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Fisiología'
AND g.finalgrade > 7
AND ra.roleid = 5;

# Ejemplo 4
Pregunta: ¿Qué estudiantes matriculados en 'Bioética' nunca ingresaron al aula?
SQL:
SELECT u.id, u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON e.id = ue.enrolid
JOIN {PREFIX}course c ON c.id = e.courseid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Bioética'
AND ra.roleid = 5
AND u.id NOT IN (
  SELECT DISTINCT userid
  FROM {PREFIX}logstore_standard_log
  WHERE courseid = c.id
);

# Ejemplo 5
Pregunta: ¿Cuántos mensajes se publicaron en el foro 'Presentación' del curso 'Microbiología'?
SQL:
SELECT COUNT(fp.id)
FROM {PREFIX}forum_posts fp
JOIN {PREFIX}forum_discussions fd ON fp.discussion = fd.id
JOIN {PREFIX}forum f ON fd.forum = f.id
JOIN {PREFIX}course c ON f.course = c.id
WHERE c.fullname = 'Microbiología'
AND f.name = 'Presentación';

# Ejemplo 6
Pregunta: ¿Cuál fue la nota más baja registrada en el curso 'Farmacología'?
SQL:
SELECT MIN(gg.finalgrade)
FROM {PREFIX}grade_grades gg
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
WHERE c.fullname = 'Farmacología';

# Ejemplo 7
Pregunta: ¿Qué estudiantes obtuvieron exactamente 10 como nota final en 'Anatomía'?
SQL:
SELECT u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Anatomía'
AND gg.finalgrade = 10
AND ra.roleid = 5;

# Ejemplo 8
Pregunta: ¿Cuántos intentos se realizaron en el examen final del curso 'Cardiología'?
SQL:
SELECT COUNT(*) 
FROM {PREFIX}quiz_attempts qa
JOIN {PREFIX}quiz q ON qa.quiz = q.id
JOIN {PREFIX}course c ON q.course = c.id
WHERE c.fullname = 'Cardiología'
AND q.name = 'Examen final';

# Ejemplo 9
Pregunta: ¿Qué estudiantes están actualmente matriculados en el curso 'Pediatría'?
SQL:
SELECT DISTINCT u.id, u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON ue.enrolid = e.id
JOIN {PREFIX}course c ON e.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Pediatría'
AND ra.roleid = 5;

# Ejemplo 10
Pregunta: ¿Cuál es el promedio del 'Examen parcial' en el curso 'Patología'?
SQL:
SELECT ROUND(AVG(gg.finalgrade),2) AS promedio
FROM {PREFIX}grade_grades gg
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
WHERE c.fullname = 'Patología'
AND gi.itemname = 'Examen parcial';

# Ejemplo 11
Pregunta: ¿Qué cursos tienen más de 50 estudiantes matriculados?
SQL:
SELECT c.fullname, COUNT(DISTINCT u.id) AS cantidad
FROM {PREFIX}course c
JOIN {PREFIX}enrol e ON c.id = e.courseid
JOIN {PREFIX}user_enrolments ue ON ue.enrolid = e.id
JOIN {PREFIX}user u ON u.id = ue.userid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE ra.roleid = 5
GROUP BY c.fullname
HAVING cantidad > 50;

# Ejemplo 12
Pregunta: ¿Cuántos estudiantes aprobaron con nota mayor a 6 en 'Farmacología'?
SQL:
SELECT COUNT(DISTINCT u.id)
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Farmacología'
AND gg.finalgrade > 6
AND ra.roleid = 5;

# Ejemplo 13
Pregunta: ¿Qué estudiantes aún no intentaron el cuestionario 'Cuestionario de introducción' en el curso 'Bioética'?
SQL:
SELECT u.id, u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON e.id = ue.enrolid
JOIN {PREFIX}course c ON c.id = e.courseid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
LEFT JOIN {PREFIX}quiz_attempts qa ON qa.userid = u.id
JOIN {PREFIX}quiz q ON q.id = qa.quiz
WHERE c.fullname = 'Bioética'
AND q.name = 'Cuestionario de introducción'
AND qa.id IS NULL
AND ra.roleid = 5;

# Ejemplo 14
Pregunta: ¿Cuántos accesos se registraron al curso 'Semiología Clínica'?
SQL:
SELECT COUNT(*) 
FROM {PREFIX}logstore_standard_log l
JOIN {PREFIX}course c ON l.courseid = c.id
WHERE c.fullname = 'Semiología Clínica';

# Ejemplo 15
Pregunta: ¿Qué mensajes publicados en los últimos 90 días contienen lenguaje inapropiado o fanático?
SQL:
SELECT u.firstname, u.lastname, fp.message, FROM_UNIXTIME(fp.created) AS fecha
FROM {PREFIX}forum_posts fp
JOIN {PREFIX}user u ON u.id = fp.userid
WHERE fp.created >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 90 DAY));

# Ejemplo 16
Pregunta: ¿Qué mensajes recientes pueden reflejar prácticas poco éticas en los foros?
SQL:
SELECT u.firstname, u.lastname, fp.message, FROM_UNIXTIME(fp.created) AS fecha
FROM {PREFIX}forum_posts fp
JOIN {PREFIX}user u ON u.id = fp.userid
WHERE fp.created >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 90 DAY));

# Ejemplo 17
Pregunta: ¿Qué estudiantes llevan más de 2 semanas sin conectarse a ningún curso?
SQL:
SELECT u.firstname, u.lastname, MAX(l.timecreated) AS ultima_conexion
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON ue.enrolid = e.id
JOIN {PREFIX}course c ON c.id = e.courseid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
LEFT JOIN {PREFIX}logstore_standard_log l ON l.userid = u.id AND l.courseid = c.id
WHERE ra.roleid = 5
GROUP BY u.id
HAVING MAX(l.timecreated) < UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 14 DAY)) OR MAX(l.timecreated) IS NULL;

# Ejemplo 18
Pregunta: ¿Qué estudiantes publicaron más mensajes en los foros del curso 'Patología'?
SQL:
SELECT u.firstname, u.lastname, COUNT(fp.id) AS mensajes
FROM {PREFIX}user u
JOIN {PREFIX}forum_posts fp ON fp.userid = u.id
JOIN {PREFIX}forum_discussions fd ON fp.discussion = fd.id
JOIN {PREFIX}forum f ON fd.forum = f.id
JOIN {PREFIX}course c ON f.course = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Patología'
AND ra.roleid = 5
GROUP BY u.id
ORDER BY mensajes DESC
LIMIT 10;

# Ejemplo 19
Pregunta: ¿Qué estudiantes accedieron más veces al curso 'Anatomía'?
SQL:
SELECT u.firstname, u.lastname, COUNT(*) AS accesos
FROM {PREFIX}logstore_standard_log l
JOIN {PREFIX}user u ON l.userid = u.id
JOIN {PREFIX}course c ON l.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Anatomía'
AND ra.roleid = 5
GROUP BY u.id
ORDER BY accesos DESC
LIMIT 10;

# Ejemplo 20
Pregunta: ¿Qué estudiantes tienen promedio mayor a 8 en el curso 'Microbiología'?
SQL:
SELECT u.firstname, u.lastname, ROUND(AVG(gg.finalgrade), 2) AS promedio
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Microbiología'
AND ra.roleid = 5
GROUP BY u.id
HAVING promedio > 8;

# Ejemplo 21
Pregunta: ¿Cuántos usuarios nuevos se registraron en la plataforma este mes?
SQL:
SELECT COUNT(*) AS nuevos_usuarios
FROM {PREFIX}user
WHERE FROM_UNIXTIME(timecreated, '%Y-%m') = DATE_FORMAT(NOW(), '%Y-%m');

# Ejemplo 22
Pregunta: ¿Cuántos mensajes de foro se publicaron por día en los últimos 7 días?
SQL:
SELECT DATE(FROM_UNIXTIME(fp.created)) AS fecha, COUNT(*) AS mensajes
FROM {PREFIX}forum_posts fp
WHERE fp.created >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 7 DAY))
GROUP BY fecha
ORDER BY fecha ASC;

# Ejemplo 23
Pregunta: ¿Cuántos intentos se realizaron en el 'Examen parcial' del curso 'Anatomía'?
SQL:
SELECT COUNT(*) 
FROM {PREFIX}quiz_attempts qa
JOIN {PREFIX}quiz q ON qa.quiz = q.id
JOIN {PREFIX}course c ON q.course = c.id
WHERE c.fullname = 'Anatomía'
AND q.name = 'Examen parcial';

# Ejemplo 24
Pregunta: ¿Qué estudiantes obtuvieron una calificación menor a 4 en alguna actividad del curso 'Fisiología'?
SQL:
SELECT DISTINCT u.firstname, u.lastname, gg.finalgrade
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Fisiología'
AND gg.finalgrade < 4
AND ra.roleid = 5;

# Ejemplo 25
Pregunta: ¿Cuántos foros están creados en el curso 'Farmacología'?
SQL:
SELECT COUNT(*) 
FROM {PREFIX}forum f
JOIN {PREFIX}course c ON f.course = c.id
WHERE c.fullname = 'Farmacología';

# Ejemplo 26
Pregunta: ¿Qué cursos tienen habilitado un certificado digital?
SQL:
SELECT c.fullname
FROM {PREFIX}course c
JOIN {PREFIX}certificate cert ON cert.course = c.id;

# Ejemplo 27
Pregunta: ¿Qué cursos utilizan recursos de tipo archivo (resource)?
SQL:
SELECT DISTINCT c.fullname
FROM {PREFIX}course c
JOIN {PREFIX}course_modules cm ON cm.course = c.id
JOIN {PREFIX}modules m ON m.id = cm.module
WHERE m.name = 'resource';

# Ejemplo 28
Pregunta: ¿Cuáles son las fechas importantes del curso 'Anatomía'?
SQL:
SELECT name, DATE_FORMAT(FROM_UNIXTIME(timestart), '%Y-%m-%d') AS inicio,
       DATE_FORMAT(FROM_UNIXTIME(timeend), '%Y-%m-%d') AS fin
FROM {PREFIX}event
WHERE courseid = (SELECT id FROM {PREFIX}course WHERE fullname = 'Anatomía');

# Ejemplo 29
Pregunta: ¿Qué estudiantes accedieron más veces al campus en general?
SQL:
SELECT u.firstname, u.lastname, COUNT(*) AS accesos
FROM {PREFIX}logstore_standard_log l
JOIN {PREFIX}user u ON u.id = l.userid
JOIN {PREFIX}context ctx ON ctx.contextlevel = 50 AND ctx.instanceid = l.courseid
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE ra.roleid = 5
GROUP BY u.id
ORDER BY accesos DESC
LIMIT 10;

# Ejemplo 30
Pregunta: Mostrame la lista de estudiantes que han aprobado al menos un curso con nota >= 6
SQL:
SELECT DISTINCT u.id, u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE gg.finalgrade >= 6
AND ra.roleid = 5;

# Ejemplo 31
Pregunta: ¿Quién es el docente responsable del curso 'Farmacología'?
SQL:
SELECT u.firstname, u.lastname
FROM {PREFIX}user u
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id
JOIN {PREFIX}context ctx ON ra.contextid = ctx.id
JOIN {PREFIX}course c ON ctx.instanceid = c.id
WHERE c.fullname = 'Farmacología'
AND ra.roleid = 3;

# Ejemplo 32
Pregunta: ¿Qué recursos están disponibles en el curso 'Microbiología' y qué tipo son?
SQL:
SELECT cm.id, m.name AS tipo_recurso
FROM {PREFIX}course_modules cm
JOIN {PREFIX}modules m ON cm.module = m.id
JOIN {PREFIX}course c ON cm.course = c.id
WHERE c.fullname = 'Microbiología';

# Ejemplo 33
Pregunta: Mostrame la lista de estudiantes ordenada por promedio en el curso 'Fisiología'
SQL:
SELECT u.firstname, u.lastname, ROUND(AVG(gg.finalgrade),2) AS promedio
FROM {PREFIX}user u
JOIN {PREFIX}grade_grades gg ON gg.userid = u.id
JOIN {PREFIX}grade_items gi ON gg.itemid = gi.id
JOIN {PREFIX}course c ON gi.courseid = c.id
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
WHERE c.fullname = 'Fisiología'
AND ra.roleid = 5
GROUP BY u.id
ORDER BY promedio DESC;

# Ejemplo 34
Pregunta: ¿Cuándo se conectó por última vez cada estudiante en el curso 'Bioética'?
SQL:
SELECT u.firstname, u.lastname, MAX(l.timecreated) AS ultima_conexion
FROM {PREFIX}user u
JOIN {PREFIX}user_enrolments ue ON ue.userid = u.id
JOIN {PREFIX}enrol e ON ue.enrolid = e.id
JOIN {PREFIX}course c ON c.id = e.courseid
JOIN {PREFIX}context ctx ON ctx.instanceid = c.id AND ctx.contextlevel = 50
JOIN {PREFIX}role_assignments ra ON ra.userid = u.id AND ra.contextid = ctx.id
LEFT JOIN {PREFIX}logstore_standard_log l ON l.userid = u.id AND l.courseid = c.id
WHERE c.fullname = 'Bioética'
AND ra.roleid = 5
GROUP BY u.id;

# Ejemplo 35
Pregunta: ¿Qué mensajes escribió el estudiante llamado Alumno3?
SQL:
SELECT u.firstname, u.lastname, fp.message
FROM {PREFIX}user u
JOIN {PREFIX}forum_posts fp ON u.id = fp.userid
JOIN {PREFIX}forum_discussions fd ON fp.discussion = fd.id
JOIN {PREFIX}forum f ON fd.forum = f.id
JOIN {PREFIX}course c ON f.course = c.id
WHERE c.fullname = 'NombreDelCurso'
AND u.firstname = 'Alumno3';